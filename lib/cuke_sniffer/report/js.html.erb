<script type="text/javascript">

    function collapseAll(css_class) {
        updateAll(css_class, "none");
    }

    function expandAll(css_class) {
        updateAll(css_class, "inline-block");
    }

    function expandAllShiftingRows(css_class) {
        var elements = document.getElementsByClassName(css_class)
        for (var i = 0; i < elements.length; i++) {
            existing_style = elements.item(i).getAttribute('style');
            elements.item(i).setAttribute('style', existing_style.replace(/display:\s*none/, "display: block-inline"));
        }
    }

    function updateAll(css_class, display_type){
        var elements = document.getElementsByClassName(css_class)
        for (var i = 0; i < elements.length; i++) {
            elements.item(i).style.display = display_type;
        }
    }

    function toggleById(item, link) {
        updateDisplayStatus(document.getElementById(item));
        toggleText(link)
    }
    function updateDisplayStatus(object) {
        if (object.tagName == "TR") {
            updateDisplayStatusForTR(object);
        } else {
            object.style.display = (object.style.display == "block") ? 'none' : "block";
        }
    }

    function updateDivScroll(divId, tableId) {
        div = document.getElementById(divId);
        table = document.getElementById(tableId);
        if (table.offsetHeight >= 500) {
            div.style.height = "75%";
            div.style.overflow = "auto";
        } else {
            div.style.height = "";
            div.style.overflow = "none";
        }

    }

    function updateDisplayStatusForTR(object) {
        existing_style = object.getAttribute('style');
        if (object.style.display == "none") {
            object.setAttribute('style', existing_style.replace(/display:\s*none/, "display: block-inline"))
        } else {
            object.setAttribute('style', existing_style.replace("display: block-inline", "display: none"))
        }
    }
    function toggleText(link) {
        var char_result = link.innerHTML.indexOf("+") > -1 ? "-" : "+";
        link.innerHTML = link.innerHTML.replace(/(\+|\-)/, char_result)
    }

    function setToggleIds() {
      var collapsibleToggleRows = document.getElementsByClassName('toggleable');
      var onclickString = "updateDisplayStatus(getElementById('%elementId%'));updateDivScroll('%divId%', '%tableId%');"

      for (var i = 0; i < collapsibleToggleRows.length; i++) {
        toggleRow = collapsibleToggleRows[i];

        var table = toggleRow.parentNode;
        console.log(toggleRow);
        console.log(table);
        var detailRowId = table.rows[ toggleRow.rowIndex + 1 ].id,
        tableId = table.id,
        divId = table.parentNode.id;

        var onclickEvent = onclickString.replace('%elementId%', detailRowId).
        replace('%tableId%', tableId).
        replace('%divId%', divId);

        toggleRow.setAttribute('onclick', onclickEvent);
      }
    }
    setToggleIds();

</script>
